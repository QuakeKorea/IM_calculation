import numpy as np

from IM_calculation.IM.Burks_Baker_2013_elastic_inelastic import Bilinear_Newmark_withTH


def test_elastic_inelastic():

    periods = np.asarray(
        [0.02, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.75, 1, 2, 3, 4, 5, 7.5, 10]
    )
    z = 0.05
    dy = 1e09
    alpha = 0
    acc = np.asarray(
        [
            3.652954e-09,
            4.2868545e-10,
            -2.7956162e-09,
            -6.0197025e-09,
            -9.243326e-09,
            -1.246624e-08,
            -1.5688194e-08,
            -1.8908944e-08,
            -2.2128239e-08,
            -2.5345834e-08,
            -2.8561484e-08,
            -3.177494e-08,
            -3.4985955e-08,
            -3.8194287e-08,
            -4.139969e-08,
            -4.4601915e-08,
            -4.7800725e-08,
            -5.0995872e-08,
            -5.4187115e-08,
            -5.737421e-08,
            -6.0556914e-08,
            -6.3734994e-08,
            -6.69082e-08,
            -7.00763e-08,
            -7.323905e-08,
            -7.639622e-08,
            -7.954756e-08,
            -8.269285e-08,
            -8.583185e-08,
            -8.896432e-08,
            -9.209003e-08,
            -9.520876e-08,
            -9.8320264e-08,
            -1.0142432e-07,
            -1.04520694e-07,
            -1.0760917e-07,
            -1.10689506e-07,
            -1.1376149e-07,
            -1.1682489e-07,
            -1.198795e-07,
            -1.2292507e-07,
            -1.259614e-07,
            -1.2898829e-07,
            -1.320055e-07,
            -1.350128e-07,
            -1.3801001e-07,
            -1.4099689e-07,
            -1.4397324e-07,
            -1.4693886e-07,
            -1.4989352e-07,
        ]
    )
    Dtg = 0.005
    Dt = 0.005
    bench = np.asarray(
        [
            1.51521e-12,
            9.55825e-12,
            3.6784e-11,
            1.37263e-10,
            3.92032e-10,
            6.6809e-10,
            8.6875e-10,
            1.13768e-09,
            1.25587e-09,
            1.39132e-09,
            1.42203e-09,
            1.4343e-09,
            1.44064e-09,
            1.44787e-09,
            1.45096e-09,
        ]
    )

    res = Bilinear_Newmark_withTH(periods, z, dy, alpha, acc, Dtg, Dt)
    assert np.allclose(res, bench)
